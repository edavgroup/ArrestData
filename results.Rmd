# Results


```{r}
library(dplyr)
library(tibble)
library(tidyr)
library(ggplot2)
library(forcats)
library(RSocrata)
library(redav)
library(UpSetR)
library(naniar)
library(rvest)
library(ggpubr)
library(ggalluvial)
```


We start to analyze the crime pattern with plotting the criminals.

With the arrest records, we plot the basic information (age, gender and race) for all arrestees. Then we could depicting the portraits for those criminal group.


```{r}
data =  read.socrata("https://data.cityofnewyork.us/Public-Safety/NYPD-Arrest-Data-Year-to-Date-/uip8-fykc")
data <- data %>%
  drop_na(pd_desc, ky_cd, pd_cd)

figure1 <- ggplot(data, aes(x=age_group))+ 
  geom_histogram(stat="count",position="identity", alpha=0.5)+
  coord_flip()+
  labs(caption="Figure.1 Age Distribution of the Criminals", 
       x="age", y="count")+ 
  theme_minimal()

figure2 <- ggplot(data, aes(x=perp_sex))+ 
  geom_histogram(stat="count",position="identity", alpha=0.5)+
  coord_flip()+
  labs(caption="Figure.2 Sex Distribution of the Criminals", 
       x="sex", y="count")+ 
  theme_minimal()

ggarrange(figure1, figure2, ncol = 2, nrow = 1)
```


```{r}
figure3 <- ggplot(data, aes(x=perp_race))+ 
  geom_histogram(stat="count",position="identity", alpha=0.5)+
  coord_flip()+
  labs(caption="Figure.3 Race Distribution of the Criminals", 
       x="race", y="count")+ 
  theme_minimal()

figure3
```

From the above three figures, we can observe the following characteristics of the captured criminalsï¼š
1. Men dominate.
2. The age group shows an approximate natural distribution pattern, mainly concentrated in 25-44 years old.
3. Black and White Hispanic mainly.
Such data can help police better understand the psychology of criminal groups.


So there is another question: What is the connection between these crime figures and the specific types of crime correspondingly?

Here we made an mosaic diagram to show that.



```{r}
library(ggmosaic)
library(vcd)
df_type <- select(data,c(age_group, perp_sex, ofns_desc))
color=c("#796B69","#95BDCC","#E7B800")
vcd::mosaic(ofns_desc~age_group+perp_sex,df_type,direction=c('v','h','h'),highlighting_fill=color)
```

